<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Executive Summary of Insights</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <style>
        /* Custom styles for visualizations and tooltips */
        .tableauPlaceholder {
            min-height: 500px;
            margin-bottom: 20px;
        }
        
        #custom-tooltip {
            position: absolute;
            display: none;
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 5px;
            pointer-events: none;
            z-index: 1000;
            max-width: 300px;
            font-size: 14px;
        }
        
        .card {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .card-body {
            flex-grow: 1;
        }
        
        .viz-container {
            height: 600px;
            width: 100%;
        }
    </style>
</head>
<body>

    <!-- Navbar (Sticky) -->
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">Salary Predictor</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="{% url 'job_market_insight' %}">Job Market & Skill Gap Insight</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'skill_gap' %}">Salary Predictor</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Custom Tooltip -->
    <div id="custom-tooltip"></div>

    <!-- Page Content (Fixed Navbar Overlap) -->
    <div class="content mt-5">
        <!-- Job Market Analysis Section -->
        <div class="container mt-5">
            <h2 class="text-center mb-4">Job Market Analysis</h2>

            <!-- Grid Layout -->
            <div class="row text-center g-4">
                <!-- Total Job Listings -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Total Job Listings</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizTotalListings'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Job Listings Dashboard' src='https://public.tableau.com/static/images/li/listings_17411225751410/Listings/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Median Salary -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Median Salary</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizMedianSalary'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Salary Dashboard' src='https://public.tableau.com/static/images/Sa/Salary_17411224408560/Salary/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Companies -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Top Companies</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizTopCompanies'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Top Companies Dashboard' src='https://public.tableau.com/static/images/Co/Company_17411227037460/Company/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Job Portals -->
                <div class="col-lg-6 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Job Platforms Distribution</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizJobPortals'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Job Portals Dashboard' src='https://public.tableau.com/static/images/jo/jobportals/JobPortals/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Job Titles -->
                <div class="col-lg-6 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Top Job Titles</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizJobTitles'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Job Titles Dashboard' src='https://public.tableau.com/static/images/Jo/JobTitles_17411064344980/JobTitles/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Skill Gap Insights Section -->
            <h2 class="text-center my-4">Skill Gap Insights</h2>

            <!-- Experience Levels Insight Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title text-center">Experience Levels Insight</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizExperience'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Experience Dashboard' src='https://public.tableau.com/static/images/Ex/Experience_17411245589340/Experience/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Top Skills and Top Qualifications Section -->
            <div class="row g-4">
                <!-- Top Skills Section -->
                <div class="col-lg-6 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title text-center">Top Skills in Demand</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizTopSkills'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Skills Dashboard' src='https://public.tableau.com/static/images/To/TopSkills_17411245230120/Skills/1_rss.png' style='border: none' />
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Qualifications Section -->
                <div class="col-lg-6 col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title text-center">Qualifications Distribution</h5>
                            <div class="viz-container">
                                <div class='tableauPlaceholder' id='vizQualifications'>
                                    <noscript>
                                        <a href='#'>
                                            <img alt='Qualifications Dashboard' src='https://public.tableau.com/static/images/Qu/Qualifications_17411245963520/Qualifications/1_rss.png' style='border: none'/>
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scroll to Top Button -->
    <button id="scrollToTop" class="btn btn-primary">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Footer (Fixed at Bottom) -->
    <footer class="footer bg-dark text-white text-center py-3">
        <p>© 2025 Salary Predictor | All Rights Reserved</p>
    </footer>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Tableau JavaScript API -->
    <script src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{% static 'js/script.js' %}"></script>

    <script>
        // Initialize all Tableau visualizations
        document.addEventListener('DOMContentLoaded', function() {
            // Configuration for all visualizations
            const vizConfigurations = [
                { id: 'vizTotalListings', url: 'https://public.tableau.com/views/listings_17411225751410/Listings' },
                { id: 'vizMedianSalary', url: 'https://public.tableau.com/views/Salary_17411224408560/Salary' },
                { id: 'vizTopCompanies', url: 'https://public.tableau.com/views/Company_17411227037460/Company' },
                { id: 'vizJobPortals', url: 'https://public.tableau.com/views/jobportals/JobPortals' },
                { id: 'vizJobTitles', url: 'https://public.tableau.com/views/JobTitles_17411064344980/JobTitles' },
                { id: 'vizExperience', url: 'https://public.tableau.com/views/Experience_17411245589340/Experience' },
                { id: 'vizTopSkills', url: 'https://public.tableau.com/views/TopSkills_17411245230120/Skills' },
                { id: 'vizQualifications', url: 'https://public.tableau.com/views/Qualifications_17411245963520/Qualifications' }
            ];

            // Initialize each visualization
            vizConfigurations.forEach(config => {
                initViz(config.id, config.url);
            });

            // Custom tooltip handling
            setupCustomTooltips();
        });

        function initViz(containerId, vizUrl) {
            const containerDiv = document.getElementById(containerId);
            const options = {
                hideTabs: true,
                hideToolbar: true,
                width: '100%',
                height: '500px',
                onFirstInteractive: function() {
                    console.log(`${containerId} has loaded`);
                }
            };
            
            const viz = new tableau.Viz(containerDiv, vizUrl, options);
            
            // Store reference to viz for later use
            containerDiv.viz = viz;
        }

    </script>
</body>
</html>